You should run the generate_mass_matrix.py first (which is run in cpu and will generate phi matrix for RBF)
If you want the gaussian result, you can directly run "test_cuda_gaussian.py" (which is run in GPU)
If you want the IMQ result, you can directly run "test_cuda_quar.py" (which is run in GPU)
When you have the npy generated by the above two files, you can run the save_mat.py and get the MATLAB input.
I test in NVIDIA RTX A6000, if you don't have enough VRAM, you can change "device = torch.device('cuda')" to "device = torch.device('cpu')", but this will make it run slower.